<?php /** based on https://stackoverflow.com/questions/14884572/zend-framework-2-navigation-menu-twitter-bootstrap-integration */
$route = $this->layout()->routeMatch;
// map routes to navigation labels because
// there isn't necessarily one-to-one correspondence
$labels = [
    'events/add' => 'add event',
    'events'  => 'schedule',
    'events/display'=>'schedule',
    'events/edit'  => 'schedule',
    'admin-defendants'  => 'defendants',
    'admin-requests' => 'requests',
    
    'requests' => 'requests',
    'requests/list' => 'list',
    'requests/create' => 'create',
    'requests/search' => 'search',
    'interpreters/find_by_language'=>'interpreters',
    'interpreters/find_by_name'=>'interpreters',
];
?>
<ul class="navbar-nav mr-auto"><?php
/* @var $page Zend\Navigation\Page\Mvc */
foreach ($this->container as $page) :
    $label = $page->getLabel();
    $active = false;
    if ( $label == $route
         or isset($labels[$route]) && $label == $labels[$route] ):
        $active = true;
    endif;
    // when using partials we need to manually check for ACL conditions
    if (false === $page->display || !$page->isVisible() || !$this->navigation()->accept($page)) :
        continue;
    endif;
    if (! $page->hasPages() or false === $page->expand_children ) :
?><li class="nav-item border-left<?php if ($active): ?> active<?php endif; ?>"><a title="<?php if ($page->title): echo $page->title; endif ?>" class="nav-link" href="<?php echo $page->getHref() ?>"><?php echo $label ?></a></li>
<?php else :
?><li class="nav-item dropdown border-left">
    <a  title="<?php if ($page->title): echo $page->title; endif ?>" href="#" class="nav-link dropdown-toggle" data-toggle="dropdown"><?php echo $page->getLabel() ?> <b class="caret"></b></a>
    <div class="dropdown-menu"><?php foreach ($page->getPages() as $child) : ?>
        <?php
        if (!$child->isVisible() || !$this->navigation()->accept($child)) :
            continue;
        endif;
        $label = $child->getLabel();
        if ($label == $route or ( isset($labels[$route]) && $label == $labels[$route] )) :
             $active = true;
         else:
             $active = false;
         endif;
        ?><a  title="<?php if ($page->title): echo $page->title; endif ?>" class="dropdown-item<?php if ($active): ?> active<?php endif;?>" href="<?php echo $child->getHref() ?>"><?php echo $child->getLabel() ?></a>
    <?php endforeach; ?>
    </div>
</li>
<?php endif; ?>
<?php endforeach;?>
</ul>
