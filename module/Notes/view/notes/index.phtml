<?php
$action = $this->layout()->action;
$is_index = !in_array($action,['edit','create']);
$this->headTitle($is_index?"MOTD|MOTW":"$action $type");
$this->headScript()->appendFile($this->basePath('js/admin/notes-form.js'));?>
<h2><?php echo $this->navigation('admin-breadcrumbs')->breadcrumbs() ?></h2>
<?php $settings = $this->layout()->note_settings;
$date_obj = new \DateTime($settings['date']);
?>
<h4><?php echo $date_obj->format('D d-M-Y')?></h4>
<ul class="nav nav-tabs" id="tabs-notes" role="tablist">
  <li class="nav-item">
    <a class="nav-link active" id="day-tab" data-toggle="tab" href="#day" role="tab" aria-controls="day" aria-selected="true">MOTD</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="week-tab" data-toggle="tab" href="#week" role="tab" aria-controls="week" aria-selected="false">MOTW</a>
  </li>
</ul>
<div class="tab-content" id="tab-content-notes">
  <div class="tab-pane pt-2 show active" id="day" role="tabpanel" aria-labelledby="day-tab">
      <div class="row">
          <div class="col">
    <?php
      if (in_array($action,['edit','create'])):
          echo $this->partial('notes/partials/form.phtml',[
              'date'=>$this->date,'type'=>$this->type,'note'=> $this->note,
               'csrf'=>$this->csrf,'action' =>$action,
          ]);
      else:

          if ($this->notes['motd']): $motd = $this->notes['motd']; echo $motd->getContent();
          ?><a href="<?php echo $this->url('notes/edit',['type'=>'motd','date'=>$motd->getDate()->format('Y-m-d') , 'id'=>$motd->getId()])?>" role="button" id="btn-edit-motd" class="btn btn-primary fas fa-edit text-light"><span class="sr-only">edit</span></a><?php
            else:
          ?><em>no MOTD for this date</em><br>
          button id="btn-create-motd" class="btn btn-primary fas fa-edit"><span class="sr-only">create</span></button<?php
            endif;
    endif;?>
      </div>
      <div id="calendar-motd" class="col"></div>
      </div>
</div>
<!--  ===============================================================-->
 <div class="tab-pane pt-2" id="week" role="tabpanel" aria-labelledby="week-tab">
    <?php if ($this->notes['motw']): echo $this->notes['motw']->getContent();
    else:
        ?><em>no MOTW for this week</em><?php
    endif;?>
  </div>
</div>
<script>
    // var btn = document.getElementById('btn-edit-motd');
    // btn.addEventListener("click",(e)=>{
    //     console.log("click!");
    //     console.log(typeof $);
    // }
    // );
</script>
