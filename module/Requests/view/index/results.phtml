<?php
if ($this->results):
    if (!count($this->results)):?>
<p>We found no records matching the above criteria.</p>
    <?php return; endif;
?>
<p>
    <?php echo $this->paginationControl($this->results, null, 'partials/pagination_head');?>
</p>
<table class="table table-sm">
    <tbody>
        <?php  $view = $this; foreach ($this->results as $r): ?>
            <tr>
                <td><?php echo $r->getDate()->format('d-M-Y')?></td>
                <td><?php echo $this->escapeHtml($r->getLanguage()) ?></td>
                <td><?php echo $this->escapeHtml($r->getEventType()) ?></td>
                <td><?php echo $this->escapeHtml($r->getDocket()) ?></td>
                <td><?php
                    $defts = $r->getDefendants();
                    if ($defts) :
                        echo implode('<br>',array_map(function($d) use ($view)
                        { return $view->escapeHtml($d->getFullName());},
                        $defts->toArray()));
                    endif;
                ?></td>
            </tr>
        <?php endforeach; ?>
    </tbody>
</table>
<?php
    echo $this->paginationControl($this->results,'sliding',
        'partials/pagination_control',['route' => 'requests/search']);
endif;
