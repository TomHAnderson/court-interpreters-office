<?php
if ($this->results):
    if (!count($this->results)):?>
<p>We found no records matching the above criteria.</p>
    <?php return; endif;
?>
<p>
    <?php echo $this->paginationControl($this->results, null, 'partials/pagination_head');?>
</p>
<?php $sample = $this->results->getItem(0); ?>
<table class="table table-sm">
    <tbody>
        <?php  $view = $this; foreach ($this->results as $r): $e = $r[0];?>
            <tr>
                <td><?php echo $e['date']->format('d-M-Y')?></td>
                <td><?php echo $r['language']//echo $this->escapeHtml($r->getLanguage()) ?></td>
                <td><?php echo $r['type'];//echo $this->escapeHtml($r->getEventType()) ?></td>
                <td><?php echo $e['docket']//this->escapeHtml($e->getDocket()) ?></td>
                <td><?php // $defts = $r->getDefendants();
                    $defts = $e['defendants'];
                    if ($defts) :
                        echo implode('<br>',array_map(function($d) use ($view)
                        { return $view->escapeHtml("{$d['surnames']}, {$d['given_names']}");},
                        $defts));
                    endif;
                ?></td>
            </tr>
        <?php endforeach; ?>
    </tbody>
</table>
<?php
    echo $this->paginationControl($this->results,'sliding',
        'partials/pagination_control',['route' => 'requests/search']);
endif;
