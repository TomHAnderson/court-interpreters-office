<?php
/** module/Admin/views/interpreters-office/admin/interpreters/index.phtml
 *  viewscript for main people-administration page
 */
$form = $this->form;
$form->get('language-select')->setValue($this->params['language_id']);
$form->get('active')->setValue($this->params['active']);
$form->get('security_clearance_expiration')->setValue($this->params['security_clearance_expiration']);
$form->get('name')->setValue(key_exists('name',$this->params)? $this->params['name']:'');
$this->headTitle($this->title);
?>
<h2>interpreters</h2>
<?php
$messenger = $this->flashMessenger()->setAutoEscape(false);
if ($messenger->hasSuccessMessages()) :
    echo $messenger->render('success', ['alert','alert-success',]);
endif;

?>
<form>
    <div class="form-group form-inline">
    <div id="form-errors" class="alert alert-warning hidden"></div>
    Find interpreters of
        <label for="language" class="sr-only">language</label> <?php echo $this->formElement($form->get('language-select'))?>
        who are <label for="active" class="sr-only">status</label>
        <?php echo $this->formSelect($form->get('active'))?>
        with security clearance <label for="security_clearance_expiration" class="sr-only">security clearance</label>
         <?php echo $this->formSelect($form->get('security_clearance_expiration'))?><!--
    --><a id="btn-search-language" href="<?php echo $this->url('interpreters') ?>" class="btn btn-success"><span class="glyphicon glyphicon-search"></span> search</a> 
    </div>
    <div class="form-group form-inline">or whose name is <?php echo $this->formElement($form->get('name'))?><a href="#" class="btn btn-success"><span class="glyphicon glyphicon-search"></span> search</a></div> 
</form>
<a href="<?php echo $this->url('interpreters/add') ?>" role="button" title="add a new interpreter" id="btn-add-interpreter" class="btn btn-info">
<span aria-hidden="true" class="icon glyphicon glyphicon-plus"></span> new interpreter
</a>
    
<pre><?php print_r($this->params) ?></pre>

<script type="text/javascript">
$(function(){
    
    console.log("boink! load");
    var languageSelect = $('#language-select'); 
    var languageButton = $('#btn-search-language');
    languageButton.on("click",function(event){
        event.preventDefault();
        var language_id = languageSelect.val() || "0";        
        var url = languageButton.attr('href');
        url += '/language/' + language_id;
        url += '/active/'+$('#active').val();
        var security = $('#security_clearance_status').val();
        if (security) {
            url += '/security/'+security;
        }
        document.location = url;
    });
});

</script>